# 🔐 اطلاعات کامل دسترسی به سیستم

## 📊 پنل مدیریت ادمین

### 🌐 آدرس‌های دسترسی

#### ورود به پنل ادمین
```
🔗 آدرس: http://localhost:5173/admin/login
👤 نام کاربری: admin
🔑 رمز عبور: admin123456
```

#### پنل اصلی ادمین (بعد از ورود)
```
📊 داشبورد: http://localhost:5173/admin
👥 مدیریت ادمین‌ها: http://localhost:5173/admin/management
📈 آنالیتیکس: http://localhost:5173/admin/analytics
💳 مدیریت پرداخت‌ها: http://localhost:5173/admin/payments
🎟️ کدهای تخفیف: http://localhost:5173/admin/discount-codes
```

---

## 🎯 قابلیت‌های پنل مدیریت

### 1. مدیریت ادمین‌ها (`/admin/management`)
```
✅ ایجاد ادمین جدید
✅ تغییر رمز عبور ادمین‌ها
✅ فعال/غیرفعال کردن ادمین
✅ حذف ادمین
✅ مشاهده لاگ فعالیت‌ها
✅ تعیین سطح دسترسی (5 سطح)
```

**سطوح دسترسی:**
- 👑 Super Admin (مدیر اصلی) - دسترسی کامل
- 🛡️ Admin (مدیر) - همه چیز بجز مدیریت ادمین‌ها
- 📝 Content Manager (مدیر محتوا) - مدیریت آگهی‌ها و دسته‌بندی‌ها
- 👁️ Moderator (ناظر) - فقط تایید/رد آگهی‌ها
- 🎧 Support (پشتیبانی) - فقط مشاهده

---

### 2. مدیریت آگهی‌ها (`/admin`)
```
✅ مشاهده لیست آگهی‌ها
✅ تایید آگهی‌ها
✅ رد آگهی‌ها
✅ ویژه کردن آگهی (مهم! 💰)
✅ ویرایش آگهی
✅ حذف آگهی
✅ مشاهده آمار بازدید
```

**ویژه کردن آگهی:**
1. به داشبورد ادمین بروید
2. آگهی را انتخاب کنید
3. روی "ویژه کردن" کلیک کنید
4. مدت زمان را انتخاب کنید (1-365 روز)
5. تایید کنید

---

### 3. مدیریت کاربران
```
✅ مشاهده لیست کاربران
✅ مسدود کردن کاربر
✅ رفع مسدودیت
✅ تنظیم کیف پول
✅ مشاهده آگهی‌های کاربر
```

---

### 4. مدیریت پرداخت‌ها (`/admin/payments`)
```
✅ مشاهده لیست پرداخت‌ها
✅ تایید پرداخت کارت به کارت
✅ رد پرداخت
✅ مشاهده رسید
✅ فیلتر بر اساس وضعیت
```

---

### 5. آنالیتیکس (`/admin/analytics`)
```
✅ آمار کلی سیستم
✅ نمودارهای فروش
✅ آمار آگهی‌ها
✅ آمار کاربران
✅ درآمد روزانه/ماهانه
```

---

### 6. کدهای تخفیف (`/admin/discount-codes`)
```
✅ ایجاد کد تخفیف
✅ ویرایش کد
✅ حذف کد
✅ فعال/غیرفعال کردن
✅ مشاهده آمار استفاده
```

---

## 🔧 دکمه‌هایی که ممکن است کار نکنند

### بررسی و رفع مشکلات

#### 1. دکمه "ویژه کردن" آگهی
**مسیر**: `/admin` → انتخاب آگهی → "ویژه کردن"

**اگر کار نمی‌کند:**
```javascript
// بررسی Console browser (F12)
// باید ببینید:
POST http://localhost:8080/api/admin/listings/:id/toggle-featured

// اگر خطا میده، لاگ backend را ببینید
```

**تست API:**
```bash
# دریافت توکن ادمین
curl -X POST http://localhost:8080/api/auth/admin/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123456"}'

# ویژه کردن آگهی (با توکن دریافتی)
curl -X POST http://localhost:8080/api/admin/listings/1/toggle-featured \
  -H "Authorization: Bearer {TOKEN}" \
  -H "Content-Type: application/json" \
  -d '{"duration_days":30}'
```

---

#### 2. دکمه "ایجاد ادمین"
**مسیر**: `/admin/management` → "ایجاد ادمین"

**اگر کار نمی‌کند:**
- بررسی کنید که با Super Admin وارد شده‌اید
- Console browser را چک کنید
- مطمئن شوید توکن معتبر است

---

#### 3. دکمه "تایید پرداخت"
**مسیر**: `/admin/payments` → انتخاب پرداخت → "تایید"

**اگر کار نمی‌کند:**
- بررسی کنید پرداخت در وضعیت pending است
- لاگ backend را ببینید

---

#### 4. دکمه "لاگ فعالیت‌ها"
**مسیر**: `/admin/management` → "لاگ فعالیت‌ها"

**اگر کار نمی‌کند:**
- بررسی کنید جدول admin_activity_log وجود دارد
- Migration را اجرا کنید: `node server/database/migrate-admin-system.js`

---

## 🧪 تست کامل سیستم

### مرحله 1: ورود به پنل ادمین
```
1. به http://localhost:5173/admin/login بروید
2. نام کاربری: admin
3. رمز عبور: admin123456
4. کلیک "ورود"
```

**انتظار**: وارد داشبورد ادمین شوید

---

### مرحله 2: مدیریت ادمین‌ها
```
1. به http://localhost:5173/admin/management بروید
2. باید ببینید:
   - لیست ادمین‌ها (1 Super Admin)
   - دکمه "ایجاد ادمین"
   - دکمه "لاگ فعالیت‌ها"
```

**تست ایجاد ادمین:**
```
1. کلیک "ایجاد ادمین"
2. نام کاربری: moderator1
3. رمز عبور: test123456
4. نام: ناظر اول
5. نقش: Moderator
6. ذخیره
```

---

### مرحله 3: ویژه کردن آگهی
```
1. به http://localhost:5173/admin بروید
2. یک آگهی را انتخاب کنید
3. روی "ویژه کردن" کلیک کنید
4. مدت: 30 روز
5. تایید
```

**بررسی نتیجه:**
```
1. به صفحه اصلی بروید: http://localhost:5173
2. آگهی ویژه شده در بالای لیست باشد
3. علامت "ویژه" روی آگهی نمایش داده شود
```

---

### مرحله 4: مشاهده آنالیتیکس
```
1. به http://localhost:5173/admin/analytics بروید
2. باید ببینید:
   - آمار کلی
   - نمودارها
   - جداول
```

---

### مرحله 5: مدیریت پرداخت‌ها
```
1. به http://localhost:5173/admin/payments بروید
2. لیست پرداخت‌ها را ببینید
3. یک پرداخت pending را تایید کنید
```

---

## 📋 Checklist کامل

### Backend
- [ ] سرور در حال اجراست (http://localhost:8080)
- [ ] Health check کار می‌کند (http://localhost:8080/health)
- [ ] دیتابیس متصل است
- [ ] Migration اجرا شده

### Frontend
- [ ] سرور در حال اجراست (http://localhost:5173)
- [ ] می‌توانم به صفحه اصلی بروم
- [ ] می‌توانم وارد پنل ادمین شوم

### پنل ادمین
- [ ] ورود با admin/admin123456 کار می‌کند
- [ ] داشبورد نمایش داده می‌شود
- [ ] مدیریت ادمین‌ها کار می‌کند
- [ ] ویژه کردن آگهی کار می‌کند
- [ ] تایید/رد آگهی کار می‌کند
- [ ] آنالیتیکس نمایش داده می‌شود
- [ ] مدیریت پرداخت‌ها کار می‌کند

---

## 🐛 رفع مشکلات رایج

### مشکل 1: نمی‌توانم وارد پنل ادمین شوم
**راه‌حل:**
```bash
# Reset Super Admin
node server/database/create-super-admin.js
```

### مشکل 2: دکمه‌ها کار نمی‌کنند
**بررسی:**
1. Console browser (F12)
2. Network tab
3. لاگ‌های backend

**راه‌حل:**
```bash
# Restart backend
# در terminal backend: Ctrl+C
node server.js

# Restart frontend
# در terminal frontend: Ctrl+C
npm run dev
```

### مشکل 3: خطای 401 Unauthorized
**علت**: توکن منقضی شده

**راه‌حل:**
1. Logout کنید
2. دوباره Login کنید

### مشکل 4: صفحه سفید یا خطای 404
**بررسی:**
1. آیا route در App.tsx اضافه شده؟
2. آیا component import شده؟

**راه‌حل:**
```bash
# بررسی لاگ‌های frontend
# در terminal frontend ببینید چه خطایی میده
```

---

## 📊 آمار فعلی سیستم

```
📋 آگهی‌ها: 13
✓ فعال: 13
⭐ ویژه: 5
👥 کاربران: 1
🔐 ادمین‌ها: 1 (Super Admin)
```

---

## 🚀 کارهایی که انجام شده

### ✅ Backend
1. سیستم مدیریت ادمین با سطح‌بندی دسترسی
2. لاگ‌گیری کامل فعالیت‌های ادمین‌ها
3. API های مدیریت ادمین
4. ویژه کردن دستی آگهی‌ها
5. سیستم پرداخت و تایید
6. کدهای تخفیف
7. آنالیتیکس

### ✅ Frontend
1. پنل ورود ادمین
2. داشبورد ادمین
3. صفحه مدیریت ادمین‌ها
4. صفحه آنالیتیکس
5. صفحه مدیریت پرداخت‌ها
6. صفحه کدهای تخفیف

### ✅ Database
1. جدول admin_users با ستون‌های جدید
2. جدول admin_activity_log
3. Migration scripts
4. Super Admin پیش‌فرض

---

## 📁 فایل‌های مهم

### مستندات
- `COMPLETE_ACCESS_INFO.md` - این فایل (اطلاعات کامل)
- `ADMIN_MANAGEMENT_SYSTEM.md` - مستندات فنی سیستم مدیریت
- `START_TESTING.md` - راهنمای شروع تست
- `OTP_TESTING_GUIDE.md` - راهنمای تست OTP
- `READY_TO_USE.md` - خلاصه سیستم

### Scripts
- `server/database/create-super-admin.js` - ایجاد Super Admin
- `server/database/migrate-admin-system.js` - Migration سیستم مدیریت
- `server/test-admin-system.js` - تست سیستم

---

## 💡 نکات مهم

### امنیت
1. ✅ حتماً رمز عبور Super Admin را تغییر دهید
2. ✅ برای هر نقش، ادمین جداگانه ایجاد کنید
3. ✅ به صورت منظم لاگ‌ها را بررسی کنید

### ویژه کردن آگهی
1. ✅ این قابلیت منبع درآمد اصلی است
2. ✅ می‌توانید به صورت دستی آگهی را ویژه کنید
3. ✅ کاربران هم می‌توانند از طریق پرداخت، آگهی را ویژه کنند

### لاگ‌گیری
1. ✅ تمام فعالیت‌های ادمین‌ها ثبت می‌شود
2. ✅ قابل فیلتر و جستجو
3. ✅ شامل IP و User Agent

---

## 🎉 همه چیز آماده است!

اگر سوالی دارید یا دکمه‌ای کار نمی‌کند:
1. Console browser را چک کنید (F12)
2. لاگ‌های backend را ببینید
3. خطای دقیق را بفرستید

موفق باشید! 🚀
